<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–Ω–±–∞–Ω-–¥–æ—Å–∫–∞</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f5;
            padding: 20px;
            min-height: 100vh;
        }
        h1 { text-align: center; margin-bottom: 30px; color: #333; }
        .sync-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: #1976d2;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            z-index: 100;
        }
        .sync-btn:hover { background: #1565c0; }
        .sync-btn:disabled { background: #ccc; }
        .board { display: flex; gap: 20px; overflow-x: auto; padding-bottom: 20px; }
        .column {
            background: #ebecf0;
            border-radius: 12px;
            width: 320px;
            min-width: 320px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            max-height: calc(100vh - 150px);
        }
        .column-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ddd;
        }
        .column-title { font-weight: 600; font-size: 16px; color: #333; }
        .column-count {
            background: #fff;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            color: #666;
        }
        .tasks { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .task {
            background: #fff;
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: grab;
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
        }
        .task:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .task.dragging { opacity: 0.5; cursor: grabbing; }
        .task-title { font-size: 14px; color: #333; margin-bottom: 8px; line-height: 1.4; padding-right: 20px; }
        .task-deadline {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        .task-deadline.overdue { color: #c62828; font-weight: 600; }
        .task-deadline.today { color: #f57c00; font-weight: 600; }
        .task-deadline.soon { color: #1976d2; }
        .task-dates {
            font-size: 11px;
            color: #888;
            margin-bottom: 8px;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        .task-dates .date-created::before { content: "üìù "; }
        .task-dates .date-closed::before { content: "‚úÖ "; }
        .task-dates .date-closed { color: #388e3c; font-weight: 500; }
        .task-meta { display: flex; gap: 8px; flex-wrap: wrap; }
        .tag { font-size: 11px; padding: 2px 6px; border-radius: 4px; font-weight: 500; }
        .tag-high { background: #ffebee; color: #c62828; }
        .tag-medium { background: #fff3e0; color: #ef6c00; }
        .tag-low { background: #e8f5e9; color: #2e7d32; }
        .tag-automation { background: #e1f5fe; color: #0277bd; }
        .tag-research { background: #f3e5f5; color: #7b1fa2; }
        .tag-integration { background: #e0f2f1; color: #00695c; }
        .tag-content { background: #fff8e1; color: #f57f17; }
        .add-task {
            margin-top: 10px;
            padding: 10px;
            background: transparent;
            border: 2px dashed #ccc;
            border-radius: 8px;
            color: #666;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        .add-task:hover { border-color: #999; color: #333; }
        .column.drag-over { background: #d4edda; }
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            width: 90%;
            max-width: 450px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .modal-title { font-size: 18px; margin-bottom: 15px; color: #333; }
        .modal input, .modal select, .modal textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .modal textarea { min-height: 80px; resize: vertical; }
        .modal label { display: block; font-size: 12px; color: #666; margin-bottom: 4px; margin-top: 8px; }
        .modal-buttons { display: flex; gap: 10px; justify-content: flex-end; margin-top: 15px; }
        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; transition: opacity 0.2s; }
        .btn:hover { opacity: 0.8; }
        .btn-primary { background: #1976d2; color: #fff; }
        .btn-secondary { background: #e0e0e0; color: #333; }
        .btn-danger { background: #c62828; color: #fff; }
        .delete-btn {
            position: absolute;
            top: 8px; right: 8px;
            color: #999;
            cursor: pointer;
            font-size: 18px;
            width: 20px; height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }
        .delete-btn:hover { color: #c62828; background: #ffebee; }
        .edit-btn {
            position: absolute;
            top: 8px; right: 32px;
            color: #999;
            cursor: pointer;
            font-size: 14px;
            width: 20px; height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }
        .edit-btn:hover { color: #1976d2; background: #e3f2fd; }
        .column-todo { border-top: 4px solid #9e9e9e; }
        .column-progress { border-top: 4px solid #1976d2; }
        .column-review { border-top: 4px solid #f57c00; }
        .column-done { border-top: 4px solid #388e3c; }
        .column-ideas { border-top: 4px solid #7c4dff; }
    </style>
</head>
<body>
    <button class="sync-btn" id="syncBtn" onclick="syncFromIssues()">üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ Issues</button>
    
    <h1>üìã –ö–∞–Ω–±–∞–Ω: –ö—Å–µ–Ω–∏—è & –ö–ª–∞—É</h1>
    
    <div class="board">
        <div class="column column-ideas" data-column="ideas">
            <div class="column-header">
                <span class="column-title">üí° –ò–¥–µ–∏</span>
                <span class="column-count">0</span>
            </div>
            <div class="tasks"></div>
            <button class="add-task" onclick="openModal('ideas')">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>
        
        <div class="column column-todo" data-column="todo">
            <div class="column-header">
                <span class="column-title">üìã –í –ø–ª–∞–Ω–µ</span>
                <span class="column-count">0</span>
            </div>
            <div class="tasks"></div>
            <button class="add-task" onclick="openModal('todo')">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>
        
        <div class="column column-progress" data-column="progress">
            <div class="column-header">
                <span class="column-title">üîß –ö–ª–∞—É –¥–µ–ª–∞–µ—Ç</span>
                <span class="column-count">0</span>
            </div>
            <div class="tasks"></div>
            <button class="add-task" onclick="openModal('progress')">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>
        
        <div class="column column-review" data-column="review">
            <div class="column-header">
                <span class="column-title">üëÄ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</span>
                <span class="column-count">0</span>
            </div>
            <div class="tasks"></div>
            <button class="add-task" onclick="openModal('review')">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>
        
        <div class="column column-done" data-column="done">
            <div class="column-header">
                <span class="column-title">‚úÖ –ì–æ—Ç–æ–≤–æ</span>
                <span class="column-count">0</span>
            </div>
            <div class="tasks"></div>
            <button class="add-task" onclick="openModal('done')">+ –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
        </div>
    </div>
    
    <div class="modal" id="modal">
        <div class="modal-content">
            <h3 class="modal-title" id="modalTitle">–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h3>
            <input type="hidden" id="taskId">
            <input type="text" id="taskTitle" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏">
            
            <label>–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–¥–µ–¥–ª–∞–π–Ω)</label>
            <input type="date" id="taskDeadline">
            
            <label>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
            <select id="taskPriority">
                <option value="high">üî¥ –í—ã—Å–æ–∫–∏–π</option>
                <option value="medium" selected>üü° –°—Ä–µ–¥–Ω–∏–π</option>
                <option value="low">üü¢ –ù–∏–∑–∫–∏–π</option>
            </select>
            
            <label>–¢–∏–ø –∑–∞–¥–∞—á–∏</label>
            <select id="taskType">
                <option value="automation">ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</option>
                <option value="research">üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ</option>
                <option value="integration">üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</option>
                <option value="content">üìù –ö–æ–Ω—Ç–µ–Ω—Ç</option>
                <option value="task" selected>üìã –î—Ä—É–≥–æ–µ</option>
            </select>
            
            <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
            <textarea id="taskDesc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"></textarea>
            
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-danger" id="deleteBtn" onclick="deleteCurrentTask()" style="display:none">–£–¥–∞–ª–∏—Ç—å</button>
                <button class="btn btn-primary" onclick="saveTask()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        const REPO_OWNER = 'aYaKseniya';
        const REPO_NAME = 'kanban-board';
        
        let currentColumn = 'todo';
        let draggedTask = null;
        let editingTaskId = null;
        let loadedIssues = [];
        
        async function syncFromIssues() {
            const btn = document.getElementById('syncBtn');
            btn.disabled = true;
            btn.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
            
            try {
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues?state=open`);
                if (!response.ok) throw new Error('Failed to fetch');
                
                const issues = await response.json();
                loadedIssues = [];
                
                // –û—á–∏—â–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏
                document.querySelectorAll('.task').forEach(t => t.remove());
                
                issues.forEach(issue => {
                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É –ø–æ label
                    let column = 'todo';
                    if (issue.labels.some(l => l.name === 'ideas')) column = 'ideas';
                    else if (issue.labels.some(l => l.name === 'progress')) column = 'progress';
                    else if (issue.labels.some(l => l.name === 'review')) column = 'review';
                    else if (issue.labels.some(l => l.name === 'done')) column = 'done';
                    
                    const task = {
                        id: 'issue-' + issue.number,
                        title: issue.title,
                        deadline: '',
                        priority: 'medium',
                        type: 'task',
                        desc: issue.body || '',
                        column: column,
                        createdAt: issue.created_at,
                        closedAt: issue.closed_at,
                        issueNumber: issue.number
                    };
                    
                    loadedIssues.push(task);
                    createTaskElement(task);
                });
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                localStorage.setItem('kanban-tasks', JSON.stringify(loadedIssues));
                updateCounts();
                
                btn.textContent = `‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ ${issues.length} –∑–∞–¥–∞—á`;
                setTimeout(() => {
                    btn.textContent = 'üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ Issues';
                    btn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Error:', error);
                btn.textContent = '‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
                setTimeout(() => {
                    btn.textContent = 'üîÑ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ Issues';
                    btn.disabled = false;
                }, 2000);
            }
        }
        
        function loadTasks() {
            const saved = localStorage.getItem('kanban-tasks');
            if (saved) {
                const tasks = JSON.parse(saved);
                tasks.forEach(task => createTaskElement(task));
                updateCounts();
            }
        }
        
        function saveTasks() {
            const tasks = [];
            document.querySelectorAll('.task').forEach(taskEl => {
                const column = taskEl.closest('.column').dataset.column;
                let closedAt = taskEl.dataset.closedAt || '';
                
                if (column === 'done' && !closedAt) {
                    closedAt = new Date().toISOString();
                    taskEl.dataset.closedAt = closedAt;
                }
                if (column !== 'done' && closedAt) {
                    closedAt = '';
                    taskEl.dataset.closedAt = '';
                }
                
                tasks.push({
                    id: taskEl.dataset.id,
                    title: taskEl.querySelector('.task-title').textContent,
                    deadline: taskEl.dataset.deadline || '',
                    priority: taskEl.dataset.priority,
                    type: taskEl.dataset.type,
                    desc: taskEl.dataset.desc || '',
                    column: column,
                    createdAt: taskEl.dataset.createdAt || new Date().toISOString(),
                    closedAt: closedAt
                });
            });
            localStorage.setItem('kanban-tasks', JSON.stringify(tasks));
        }
        
        function openModal(column, taskId = null) {
            currentColumn = column;
            editingTaskId = taskId;
            
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modalTitle');
            const deleteBtn = document.getElementById('deleteBtn');
            
            if (taskId) {
                const taskEl = document.querySelector(`[data-id="${taskId}"]`);
                modalTitle.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É';
                document.getElementById('taskId').value = taskId;
                document.getElementById('taskTitle').value = taskEl.querySelector('.task-title').textContent;
                document.getElementById('taskDeadline').value = taskEl.dataset.deadline || '';
                document.getElementById('taskPriority').value = taskEl.dataset.priority;
                document.getElementById('taskType').value = taskEl.dataset.type;
                document.getElementById('taskDesc').value = taskEl.dataset.desc || '';
                deleteBtn.style.display = 'inline-block';
            } else {
                modalTitle.textContent = '–ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞';
                document.getElementById('taskId').value = '';
                document.getElementById('taskTitle').value = '';
                document.getElementById('taskDeadline').value = '';
                document.getElementById('taskPriority').value = 'medium';
                document.getElementById('taskType').value = 'task';
                document.getElementById('taskDesc').value = '';
                deleteBtn.style.display = 'none';
            }
            
            modal.classList.add('active');
            document.getElementById('taskTitle').focus();
        }
        
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            editingTaskId = null;
        }
        
        function saveTask() {
            const title = document.getElementById('taskTitle').value.trim();
            if (!title) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏');
                return;
            }
            
            let oldTaskData = null;
            if (editingTaskId) {
                const oldEl = document.querySelector(`[data-id="${editingTaskId}"]`);
                oldTaskData = { createdAt: oldEl.dataset.createdAt };
                oldEl.remove();
            }
            
            const taskData = {
                id: editingTaskId || 'task-' + Date.now(),
                title: title,
                deadline: document.getElementById('taskDeadline').value,
                priority: document.getElementById('taskPriority').value,
                type: document.getElementById('taskType').value,
                desc: document.getElementById('taskDesc').value.trim(),
                column: currentColumn,
                createdAt: editingTaskId ? (oldTaskData?.createdAt || new Date().toISOString()) : new Date().toISOString()
            };
            
            createTaskElement(taskData);
            saveTasks();
            updateCounts();
            closeModal();
        }
        
        function deleteCurrentTask() {
            if (editingTaskId && confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É?')) {
                const taskEl = document.querySelector(`[data-id="${editingTaskId}"]`);
                if (taskEl) {
                    taskEl.remove();
                    saveTasks();
                    updateCounts();
                }
                closeModal();
            }
        }
        
        function deleteTask(btn) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É?')) {
                btn.closest('.task').remove();
                saveTasks();
                updateCounts();
            }
        }
        
        function createTaskElement(task) {
            const taskEl = document.createElement('div');
            taskEl.className = 'task';
            taskEl.draggable = true;
            taskEl.dataset.id = task.id;
            taskEl.dataset.deadline = task.deadline || '';
            taskEl.dataset.priority = task.priority;
            taskEl.dataset.type = task.type;
            taskEl.dataset.desc = task.desc || '';
            taskEl.dataset.createdAt = task.createdAt || '';
            taskEl.dataset.closedAt = task.closedAt || '';
            
            const priorityClass = 'tag-' + task.priority;
            const typeClasses = {
                'automation': 'tag-automation',
                'research': 'tag-research', 
                'integration': 'tag-integration',
                'content': 'tag-content'
            };
            const typeLabels = {
                'automation': 'ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è',
                'research': 'üîç –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ',
                'integration': 'üîå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è', 
                'content': 'üìù –ö–æ–Ω—Ç–µ–Ω—Ç'
            };
            const typeClass = typeClasses[task.type] || '';
            const typeLabel = typeLabels[task.type] || '';
            
            let deadlineHtml = '';
            if (task.deadline) {
                const deadlineClass = getDeadlineClass(task.deadline);
                const deadlineText = formatDeadline(task.deadline);
                deadlineHtml = `<div class="task-deadline ${deadlineClass}">üìÖ ${deadlineText}</div>`;
            }
            
            let datesHtml = '';
            if (task.createdAt || task.closedAt) {
                let datesContent = '';
                if (task.createdAt) {
                    const createdDate = new Date(task.createdAt).toLocaleDateString('ru-RU', { day: 'numeric', month: 'short' });
                    datesContent += `<span class="date-created">–°–æ–∑–¥–∞–Ω–æ: ${createdDate}</span>`;
                }
                if (task.closedAt) {
                    const closedDate = new Date(task.closedAt).toLocaleDateString('ru-RU', { day: 'numeric', month: 'short' });
                    datesContent += `<span class="date-closed">–ó–∞–∫—Ä—ã—Ç–æ: ${closedDate}</span>`;
                }
                datesHtml = `<div class="task-dates">${datesContent}</div>`;
            }
            
            taskEl.innerHTML = `
                <span class="edit-btn" onclick="event.stopPropagation(); openModal('${task.column}', '${task.id}')">‚úé</span>
                <span class="delete-btn" onclick="event.stopPropagation(); deleteTask(this)">√ó</span>
                <div class="task-title">${escapeHtml(task.title)}</div>
                ${datesHtml}
                ${deadlineHtml}
                <div class="task-meta">
                    <span class="tag ${priorityClass}">${getPriorityLabel(task.priority)}</span>
                    ${typeLabel ? `<span class="tag ${typeClass}">${typeLabel}</span>` : ''}
                </div>
            `;
            
            taskEl.addEventListener('dragstart', (e) => {
                draggedTask = taskEl;
                taskEl.classList.add('dragging');
            });
            
            taskEl.addEventListener('dragend', () => {
                draggedTask = null;
                taskEl.classList.remove('dragging');
                document.querySelectorAll('.column').forEach(col => {
                    col.classList.remove('drag-over');
                });
                saveTasks();
                updateCounts();
            });
            
            const column = document.querySelector(`[data-column="${task.column}"]`);
            if (column) {
                column.querySelector('.tasks').appendChild(taskEl);
            }
        }
        
        function getDeadlineClass(deadline) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const deadlineDate = new Date(deadline);
            deadlineDate.setHours(0, 0, 0, 0);
            const diffDays = Math.floor((deadlineDate - today) / (1000 * 60 * 60 * 24));
            if (diffDays < 0) return 'overdue';
            if (diffDays === 0) return 'today';
            if (diffDays <= 3) return 'soon';
            return '';
        }
        
        function formatDeadline(deadline) {
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const deadlineDate = new Date(deadline);
            deadlineDate.setHours(0, 0, 0, 0);
            const diffDays = Math.floor((deadlineDate - today) / (1000 * 60 * 60 * 24));
            const options = { day: 'numeric', month: 'short' };
            const dateStr = deadlineDate.toLocaleDateString('ru-RU', options);
            if (diffDays < 0) return `–ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ: ${dateStr}`;
            if (diffDays === 0) return `–°–µ–≥–æ–¥–Ω—è: ${dateStr}`;
            if (diffDays === 1) return `–ó–∞–≤—Ç—Ä–∞: ${dateStr}`;
            if (diffDays <= 3) return `–ß–µ—Ä–µ–∑ ${diffDays} –¥–Ω: ${dateStr}`;
            return dateStr;
        }
        
        function updateCounts() {
            document.querySelectorAll('.column').forEach(column => {
                const count = column.querySelectorAll('.task').length;
                column.querySelector('.column-count').textContent = count;
            });
        }
        
        function getPriorityLabel(priority) {
            const labels = { high: 'üî¥ –í—ã—Å–æ–∫–∏–π', medium: 'üü° –°—Ä–µ–¥–Ω–∏–π', low: 'üü¢ –ù–∏–∑–∫–∏–π' };
            return labels[priority] || priority;
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        document.querySelectorAll('.column').forEach(column => {
            column.addEventListener('dragover', (e) => {
                e.preventDefault();
                column.classList.add('drag-over');
            });
            
            column.addEventListener('dragleave', () => {
                column.classList.remove('drag-over');
            });
            
            column.addEventListener('drop', (e) => {
                e.preventDefault();
                column.classList.remove('drag-over');
                if (draggedTask) {
                    column.querySelector('.tasks').appendChild(draggedTask);
                    saveTasks();
                    updateCounts();
                }
            });
        });
        
        document.getElementById('taskTitle').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') saveTask();
        });
        
        document.getElementById('modal').addEventListener('click', (e) => {
            if (e.target.id === 'modal') closeModal();
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });
        
        loadTasks();
    </script>
</body>
</html>
